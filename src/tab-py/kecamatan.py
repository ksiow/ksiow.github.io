import requests
import json
import time

REGENCY_CODES = ['11.01', '11.02', '11.03', '11.04', '11.05', '11.06', '11.07', '11.08', '11.09', '11.10', '11.11', '11.12', '11.13', '11.14', '11.15', '11.16', '11.17', '11.18', '11.71', '11.72', '11.73', '11.74', '11.75', '12.01', '12.02', '12.03', '12.04', '12.05', '12.06', '12.07', '12.08', '12.09', '12.10', '12.11', '12.12', '12.13', '12.14', '12.15', '12.16', '12.17', '12.18', '12.19', '12.20', '12.21', '12.22', '12.23', '12.24', '12.25', '12.71', '12.72', '12.73', '12.74', '12.75', '12.76', '12.77', '12.78', '13.01', '13.02', '13.03', '13.04', '13.05', '13.06', '13.07', '13.08', '13.09', '13.10', '13.11', '13.12', '13.71', '13.72', '13.73', '13.74', '13.75', '13.76', '13.77', '14.01', '14.02', '14.03', '14.04', '14.05', '14.06', '14.07', '14.08', '14.09', '14.10', '14.71', '14.72', '15.01', '15.02', '15.03', '15.04', '15.05', '15.06', '15.07', '15.08', '15.09', '15.71', '15.72', '16.01', '16.02', '16.03', '16.04', '16.05', '16.06', '16.07', '16.08', '16.09', '16.10', '16.11', '16.12', '16.13', '16.71', '16.72', '16.73', '16.74', '17.01', '17.02', '17.03', '17.04', '17.05', '17.06', '17.07', '17.08', '17.09', '17.71', '18.01', '18.02', '18.03', '18.04', '18.05', '18.06', '18.07', '18.08', '18.09', '18.10', '18.11', '18.12', '18.13', '18.71', '18.72', '19.01', '19.02', '19.03', '19.04', '19.05', '19.06', '19.71', '21.01', '21.02', '21.03', '21.04', '21.05', '21.71', '21.72', '31.01', '31.71', '31.72', '31.73', '31.74', '31.75', '32.01', '32.02', '32.03', '32.04', '32.05', '32.06', '32.07', '32.08', '32.09', '32.10', '32.11', '32.12', '32.13', '32.14', '32.15', '32.16', '32.17', '32.18', '32.71', '32.72', '32.73', '32.74', '32.75', '32.76', '32.77', '32.78', '32.79', '33.01', '33.02', '33.03', '33.04', '33.05', '33.06', '33.07', '33.08', '33.09', '33.10', '33.11', '33.12', '33.13', '33.14', '33.15', '33.16', '33.17', '33.18', '33.19', '33.20', '33.21', '33.22', '33.23', '33.24', '33.25', '33.26', '33.27', '33.28', '33.29', '33.71', '33.72', '33.73', '33.74', '33.75', '33.76', '34.01', '34.02', '34.03', '34.04', '34.71', '35.01', '35.02', '35.03', '35.04', '35.05', '35.06', '35.07', '35.08', '35.09', '35.10', '35.11', '35.12', '35.13', '35.14', '35.15', '35.16', '35.17', '35.18', '35.19', '35.20', '35.21', '35.22', '35.23', '35.24', '35.25', '35.26', '35.27', '35.28', '35.29', '35.71', '35.72', '35.73', '35.74', '35.75', '35.76', '35.77', '35.78', '35.79', '36.01', '36.02', '36.03', '36.04', '36.71', '36.72', '36.73', '36.74', '51.01', '51.02', '51.03', '51.04', '51.05', '51.06', '51.07', '51.08', '51.71', '52.01', '52.02', '52.03', '52.04', '52.05', '52.06', '52.07', '52.08', '52.71', '52.72', '53.01', '53.02', '53.03', '53.04', '53.05', '53.06', '53.07', '53.08', '53.09', '53.10', '53.11', '53.12', '53.13', '53.14', '53.15', '53.16', '53.17', '53.18', '53.19', '53.20', '53.21', '53.71', '61.01', '61.02', '61.03', '61.04', '61.05', '61.06', '61.07', '61.08', '61.09', '61.10', '61.11', '61.12', '61.71', '61.72', '62.01', '62.02', '62.03', '62.04', '62.05', '62.06', '62.07', '62.08', '62.09', '62.10', '62.11', '62.12', '62.13', '62.71', '63.01', '63.02', '63.03', '63.04', '63.05', '63.06', '63.07', '63.08', '63.09', '63.10', '63.11', '63.71', '63.72', '64.01', '64.02', '64.03', '64.07', '64.08', '64.09', '64.11', '64.71', '64.72', '64.74', '65.01', '65.02', '65.03', '65.04', '65.71', '71.01', '71.02', '71.03', '71.04', '71.05', '71.06', '71.07', '71.08', '71.09', '71.10', '71.11', '71.71', '71.72', '71.73', '71.74', '72.01', '72.02', '72.03', '72.04', '72.05', '72.06', '72.07', '72.08', '72.09', '72.10', '72.11', '72.12', '72.71', '73.01', '73.02', '73.03', '73.04', '73.05', '73.06', '73.07', '73.08', '73.09', '73.10', '73.11', '73.12', '73.13', '73.14', '73.15', '73.16', '73.17', '73.18', '73.22', '73.24', '73.26', '73.71', '73.72', '73.73', '74.01', '74.02', '74.03', '74.04', '74.05', '74.06', '74.07', '74.08', '74.09', '74.10', '74.11', '74.12', '74.13', '74.14', '74.15', '74.71', '74.72', '75.01', '75.02', '75.03', '75.04', '75.05', '75.71', '76.01', '76.02', '76.03', '76.04', '76.05', '76.06', '81.01', '81.02', '81.03', '81.04', '81.05', '81.06', '81.07', '81.08', '81.09', '81.71', '81.72', '82.01', '82.02', '82.03', '82.04', '82.05', '82.06', '82.07', '82.08', '82.71', '82.72', '91.03', '91.05', '91.06', '91.10', '91.11', '91.15', '91.19', '91.20', '91.71', '92.01', '92.02', '92.03', '92.04', '92.05', '92.06', '92.07', '92.08', '92.09', '92.10', '92.11', '92.12', '92.71', '93.01', '93.02', '93.03', '93.04', '94.01', '94.02', '94.03', '94.04', '94.05', '94.06', '94.07', '94.08', '95.01', '95.02', '95.03', '95.04', '95.05', '95.06', '95.07', '95.08']



def fetch_data(regency_code):
    url = f"https://wilayah.id/api/districts/{regency_code}.json"
    try:
        response = requests.get(url)
        response.raise_for_status()  
        
        
        data = response.json().get("data", [])
        extracted_data = [{"code": item["code"], "name": item["name"]} for item in data]
        
        return extracted_data
    except requests.HTTPError as e:
        print(f"HTTP error occurred for regency code {regency_code}: {e}")
        return None
    except Exception as e:
        print(f"An error occurred for regency code {regency_code}: {e}")
        return None


all_data = {}
for code in REGENCY_CODES:
    data = fetch_data(code)
    if data:
        all_data[code] = data
        time.sleep(1)


with open('kecamatan_data.json', 'w') as file:
    json.dump(all_data, file, indent=4)

print('Extracted data saved in kecamatan_data.json')
